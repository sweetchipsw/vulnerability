# CVE-2014-1799

- Use-after-free
- Vtguard
  - Bypassed 'Vtguard' mitigation without using any other memory leak vulnerability.
  - Not every memory object of IE has vtguard applied to it. Thus, IE can be exploited by manipulating data to use vulnerable object (to which vtguard mitigation is not applied)
  - Check eip_poc.html
- Log

```
0:026> g
(2374.1efc): C++ EH exception - code e06d7363 (first chance)
(2374.1efc): C++ EH exception - code e06d7363 (first chance)
(2374.1efc): C++ EH exception - code e06d7363 (first chance)
(2374.1efc): Access violation - code c0000005 (first chance)
First chance exceptions are reported before any exception handling.
This exception may be expected and handled.
eax=20202008 ebx=00000000 ecx=20202014 edx=08080808 esi=202020fc edi=20202014
eip=90909090 esp=03ec8548 ebp=03ec8560 iopl=0 nv up ei pl nz na pe nc
cs=0023 ss=002b ds=002b es=002b fs=0053 gs=002b efl=00010206
90909090 ?? ???
0:008> k
ChildEBP RetAddr
WARNING: Frame IP not in any known module. Following frames may be wrong.
03ec8544 62abf8c1 0x90909090
03ec8560 62ae2b8f MSHTML!CSharedStyleSheet::RecomputeStyleStatistics+0x71
03ec8578 62ae2b4c MSHTML!CStyleSheet::RecomputeStyleStatistics+0x2a
03ec8590 62ae2b1d MSHTML!CStyleSheetArray::RecomputeStyleStatistics+0x25
03ec85a0 62ab8fa9 MSHTML!CMarkup::RecomputeStyleStatisticsWorker+0x61
03ec8600 62fd6188 MSHTML!NotifyAncestors+0x67c
03ec8660 62efe884 MSHTML!CMarkup::SendNotification+0x154
03ec8688 62bdaffe MSHTML!CMarkup::Notify+0xb8
```

* Credit : sweetchip@GRAYHASH